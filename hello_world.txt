Made some changes here as well